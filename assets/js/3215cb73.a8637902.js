"use strict";(self.webpackChunkadminforth=self.webpackChunkadminforth||[]).push([[6551],{36241:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>t,toc:()=>d});var i=s(74848),r=s(28453);const a={},o="Email password reset",t={id:"tutorial/Plugins/email-password-reset",title:"Email password reset",description:"Plugin allows to reset password for admin users who forgot their password by sending email with reset link signed with secured JWT token.",source:"@site/docs/tutorial/07-Plugins/07-email-password-reset.md",sourceDirName:"tutorial/07-Plugins",slug:"/tutorial/Plugins/email-password-reset",permalink:"/docs/tutorial/Plugins/email-password-reset",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:7,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Text Complete",permalink:"/docs/tutorial/Plugins/text-complete"},next:{title:"Import-Export",permalink:"/docs/tutorial/Plugins/import-export"}},l={},d=[{value:"SES",id:"ses",level:2},{value:"Mailgun",id:"mailgun",level:2},{value:"Password reset page injection",id:"password-reset-page-injection",level:2}];function c(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"email-password-reset",children:"Email password reset"}),"\n",(0,i.jsx)(n.p,{children:"Plugin allows to reset password for admin users who forgot their password by sending email with reset link signed with secured JWT token."}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u26a0\ufe0f if users created manually in backoffice, ensuring that email is valid is responsibility of the admin which might be a security risk\n(if email is mistyped then, person who owns mistyped email can reset password and get access)"}),"\n"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u26a0\ufe0f If user with email does not exist, plugin will still show to user success message to prevent email enumeration."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Installation:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npm install @adminforth/email-password-reset --save\nnpm install @adminforth/email-adapter-aws-ses --save\n"})}),"\n",(0,i.jsx)(n.p,{children:"Import plugin:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import EmailResetPasswordPlugin from '@adminforth/email-password-reset';\n"})}),"\n",(0,i.jsx)(n.h2,{id:"ses",children:"SES"}),"\n",(0,i.jsx)(n.p,{children:"To Setup SES, you need to have an AWS account and SES service enabled. You can follow the steps below to setup SES."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Go to the AWS Management Console and open the Amazon SES console at ",(0,i.jsx)(n.a,{href:"https://console.aws.amazon.com/ses/",children:"https://console.aws.amazon.com/ses/"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Make sure you are in the correct region. You can change the region from the top right corner. For example, if you are in the ",(0,i.jsx)(n.code,{children:"us-east-1"})," region, you can see the region name US East (N. Virginia) in the top right corner."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Add your email address (any email), and verify it."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Add some domain you own and verify it by creating DNS records which AWS suggests. This will be used as the domain for sending emails. e.g. if you want to send from ",(0,i.jsx)(n.a,{href:"mailto:no-reply@devforth.io",children:"no-reply@devforth.io"})," you need to verify ",(0,i.jsx)(n.code,{children:"devforth.io"}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Add plugin to user resource:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",metastring:"./resources/adminuser.ts",children:"import EmailResetPasswordPlugin from '@adminforth/email-password-reset';\nimport EmailAdapterAwsSes from '@adminforth/email-adapter-aws-ses';\n...\nplugins: [\n  ...\n  new EmailResetPasswordPlugin({\n    // field in user resource which contains email\n    emailField: 'email',\n\n    // field in user resource which contains password constrains. Should be virtual field\n    passwordField: 'password',\n\n    // domain part should be verified in SES\n    sendFrom: 'no-reply@devforth.io',\n\n    adapter: new EmailAdapterAwsSes({\n        // region where SES is setup\n        region: \"eu-central-1\",\n        accessKeyId: process.env.AWS_ACCESS_KEY_ID as string,\n        secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY as string,\n      }),\n\n  }),\n]\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Make sure to place your AWS credentials in ",(0,i.jsx)(n.code,{children:".env"})," file/environment."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:"/.env",children:"AWS_ACCESS_KEY_ID=your-access-key\nAWS_SECRET_ACCESS_KEY=your-secret-key\n"})}),"\n",(0,i.jsx)(n.h2,{id:"mailgun",children:"Mailgun"}),"\n",(0,i.jsx)(n.p,{children:"To Setup Mailgun, you need to have an account and Mailgun service enabled. You can follow the steps below to setup Mailgun."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Go to ",(0,i.jsx)(n.a,{href:"https://www.mailgun.com/",children:"https://www.mailgun.com/"})," and create an account."]}),"\n",(0,i.jsx)(n.li,{children:"Add your email address (any email), and verify it."}),"\n",(0,i.jsx)(n.li,{children:"Add your domain (any domain) and verify it."}),"\n",(0,i.jsx)(n.li,{children:"Add your API key."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Add plugin to user resource:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",metastring:"./resources/adminuser.ts",children:"import EmailResetPasswordPlugin from '@adminforth/email-password-reset';\nimport EmailAdapterMailgun from '@adminforth/email-adapter-mailgun';\n...\nplugins: [\n  ...\n  new EmailResetPasswordPlugin({\n    // field in user resource which contains email\n    emailField: 'email',\n\n    // field in user resource which contains password constrains. Should be virtual field\n    passwordField: 'password',\n\n    // domain part should be verified in Mailgun\n    sendFrom: 'no-reply@devforth.io',\n\n    adapter: new EmailAdapterMailgun({\n        apiKey: process.env.MAILGUN_API_KEY as string,\n        domain: process.env.MAILGUN_DOMAIN as string,\n        //baseUrl is optional, if not provided, will default to \"https://api.mailgun.net\" but if you are using Mailgun EU, you should use \"https://api.eu.mailgun.net\" instead\n        baseUrl: process.env.MAILGUN_REGION_URL as string,\n      }),\n\n  }),\n]\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Make sure to place your Mailgun credentials in ",(0,i.jsx)(n.code,{children:".env"})," file/environment."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:"/.env",children:"MAILGUN_API_KEY=your-api-key\nMAILGUN_DOMAIN=your-domain\nMAILGUN_REGION_URL=your-region-url # optional\n"})}),"\n",(0,i.jsx)(n.h2,{id:"password-reset-page-injection",children:"Password reset page injection"}),"\n",(0,i.jsx)(n.p,{children:"If you want create custom header, or want to add some data under input, you can add:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",metastring:"title='./resources/users'",children:'  new EmailResetPasswordPlugin({\n    ...\n  //diff-add\n    pageInjection: {\n    //diff-add  \n      panelHeader: "@@/YourCustomHeader";\n    //diff-add\n      underInputs: "@@/YourUnderInput";\n    //diff-add\n    }\n    ...\n  })\n'})})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>t});var i=s(96540);const r={},a=i.createContext(r);function o(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);
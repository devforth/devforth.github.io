"use strict";(self.webpackChunkadminforth=self.webpackChunkadminforth||[]).push([[1768],{9706:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>m,frontMatter:()=>s,metadata:()=>r,toc:()=>l});var o=t(4848),i=t(8453);const s={},a="Page Injections",r={id:"tutorial/Customization/pageInjections",title:"Page Injections",description:"In addition to ability to create custom pages and overwrite how fields are rendered, you can also inject custom components in standard AdminForth page.",source:"@site/docs/tutorial/03-Customization/08-pageInjections.md",sourceDirName:"tutorial/03-Customization",slug:"/tutorial/Customization/pageInjections",permalink:"/docs/tutorial/Customization/pageInjections",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:8,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Alerts and confirmations",permalink:"/docs/tutorial/Customization/alert"},next:{title:"Actions",permalink:"/docs/tutorial/Customization/Actions"}},c={},l=[{value:"Login page customization",id:"login-page-customization",level:2},{value:"List view page injections shrinking: thin enough to shrink?",id:"list-view-page-injections-shrinking-thin-enough-to-shrink",level:2},{value:"Three dots menu customization",id:"three-dots-menu-customization",level:2},{value:"List table custom action icons",id:"list-table-custom-action-icons",level:2},{value:"Global Injections",id:"global-injections",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{id:"page-injections",children:"Page Injections"}),"\n",(0,o.jsx)(n.p,{children:"In addition to ability to create custom pages and overwrite how fields are rendered, you can also inject custom components in standard AdminForth page."}),"\n",(0,o.jsxs)(n.p,{children:["For example let's add a custom pie chart to the ",(0,o.jsx)(n.code,{children:"list"})," page of the ",(0,o.jsx)(n.code,{children:"aparts"})," resource. Pie chart will show the distribution of the rooms count and more over will allow to filter the list by the rooms count."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",metastring:'title="./resources/apartments.ts"',children:"{\n  resourceId: 'aparts',\n  ...\n//diff-add\n  options: {\n//diff-add\n    pageInjections: {\n//diff-add\n      list: {\n//diff-add\n        afterBreadcrumbs: '@@/ApartsPie.vue',\n//diff-add\n      }\n//diff-add\n    }   \n//diff-add\n  }\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Now create file ",(0,o.jsx)(n.code,{children:"ApartsPie.vue"})," in the ",(0,o.jsx)(n.code,{children:"custom"})," folder of your project:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-html",metastring:'title="./custom/ApartsPie.vue"',children:'<template>\n    <div class="max-w-sm w-full bg-white rounded-lg shadow dark:bg-gray-800 p-4 md:p-4 mb-5">\n      <PieChart\n        v-if="data.length"\n        :data="rooms" \n        :options="{\n          chart: {\n            height: 250,\n          },\n          dataLabels: {\n            enabled: true,\n          },\n          plotOptions: {\n            pie: {\n              dataLabels: {\n                offset: -10,\n                minAngleToShowLabel: 10,\n              },\n              expandOnClick: true,\n            },\n          },\n        }"\n      />\n      <div v-else>Loading...</div>\n    </div>\n  </template>\n  \n  \n  <script setup lang="ts">\n  import { onMounted, ref, Ref, computed } from \'vue\';\n  import { PieChart } from \'@/afcl\';\n  import { callApi } from \'@/utils\';\n  import adminforth from \'@/adminforth\';\n  \n  \n  const data: Ref<any[]> = ref([]);\n\n\n  const COLORS = ["#4E79A7", "#F28E2B", "#E15759", "#76B7B2", "#59A14F"]\n  const rooms = computed(() => {\n    return data.value?.map(\n      (item, i) => ({\n        label: item.rooms + \' rooms\',\n        amount: item.percentage,\n        color: COLORS[i],\n      })\n    );\n  });\n\n  onMounted(async () => {\n    try {\n    data.value = await callApi({ path: \'/api/aparts-by-room-percentages\', method: \'GET\' });\n    } catch (error) {\n      adminforth.alert({\n        message: `Error fetching data: ${error.message}`,\n        variant: \'danger\',\n        timeout: \'unlimited\'\n      });\n      return;\n    }\n  })\n  \n  <\/script>\n'})}),"\n",(0,o.jsx)(n.p,{children:"Also we have to add an Api to get percentages:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",metastring:'title="./index.ts"',children:"  app.get(`${ADMIN_BASE_URL}/api/aparts-by-room-percentages/`,\n    admin.express.authorize(\n      async (req, res) => {\n        const roomPercentages = await admin.resource('aparts').dataConnector.client.prepare(\n          `SELECT \n            number_of_rooms, \n            COUNT(*) as count \n          FROM apartments \n          GROUP BY number_of_rooms\n          ORDER BY number_of_rooms;\n          `\n        ).all()\n        \n\n        const totalAparts = roomPercentages.reduce((acc, { count }) => acc + count, 0);\n\n        res.json(\n          roomPercentages.map(\n            ({ number_of_rooms, count }) => ({\n              rooms: number_of_rooms,\n              percentage: Math.round(count / totalAparts * 100),\n            })\n          )\n        );\n      }\n    )\n  );\n\n  // serve after you added all api\n  admin.discoverDatabases();\n  admin.express.serve(app)\n"})}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["\u261d\ufe0f Please note that we are using ",(0,o.jsx)(n.a,{href:"/docs/api/FrontendAPI/interfaces/FrontendAPIInterface/",children:"Frontend API"})," ",(0,o.jsx)(n.code,{children:"adminforth.list.updateFilter({field: 'number_of_rooms', operator: 'eq', value: selectedRoomsCount});"})," to set filter when we are located on apartments list page"]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Here is how it looks:\n",(0,o.jsx)(n.img,{alt:"alt text",src:t(5694).A+"",width:"2541",height:"1315"})]}),"\n",(0,o.jsx)(n.h2,{id:"login-page-customization",children:"Login page customization"}),"\n",(0,o.jsx)(n.p,{children:"You can also inject custom components to the login page."}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"loginPageInjections.underInputs"})," and ",(0,o.jsx)(n.code,{children:"loginPageInjections.panelHeader"})," allows to add one or more panels under or over the login form inputs:"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"login Page Injections underInputs",src:t(1694).A+"",width:"2362",height:"1293"})}),"\n",(0,o.jsx)(n.p,{children:"For example:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",metastring:'title="/index.ts"',children:"\nnew AdminForth({\n  ...\n  customization: {\n    loginPageInjections: {\n      underInputs: '@@/CustomLoginFooter.vue',\n    }\n    ...\n  }\n\n  ...\n})\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Now create file ",(0,o.jsx)(n.code,{children:"CustomLoginFooter.vue"})," in the ",(0,o.jsx)(n.code,{children:"custom"})," folder of your project:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-html",metastring:'title="./custom/CustomLoginFooter.vue"',children:'<template>\n  <div class="text-center text-gray-500 text-sm mt-4">\n    {{$t(\'By logging in, you agree to our\')}} <a href="#" class="text-blue-500">{{$t(\'Terms of Service\')}}</a> {{$t(\'and\')}} <a href="#" class="text-blue-500">{{$t(\'Privacy Policy\')}}</a>\n  </div>\n</template>\n'})}),"\n",(0,o.jsxs)(n.p,{children:["Also you can add ",(0,o.jsx)(n.code,{children:"panelHeader"})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",metastring:'title="/index.ts"',children:"\nnew AdminForth({\n  ...\n  customization: {\n    loginPageInjections: {\n      underInputs: '@@/CustomLoginFooter.vue',\n//diff-add\n      panelHeader: '@@/CustomLoginHeader.vue',\n    }\n    ...\n  }\n\n  ...\n})\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Now create file ",(0,o.jsx)(n.code,{children:"CustomLoginHeader.vue"})," in the ",(0,o.jsx)(n.code,{children:"custom"})," folder of your project:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-html",metastring:'title="./custom/CustomLoginHeader.vue"',children:'<template>\n    <div class="flex items-center justify-center gap-2">\n        <div class="text-2xl text-black dark:text-white font-bold">\n          AdminForth\n        </div>\n    </div>\n</template>\n'})}),"\n",(0,o.jsx)(n.h2,{id:"list-view-page-injections-shrinking-thin-enough-to-shrink",children:"List view page injections shrinking: thin enough to shrink?"}),"\n",(0,o.jsxs)(n.p,{children:["When none of ",(0,o.jsx)(n.code,{children:"bottom"}),", ",(0,o.jsx)(n.code,{children:"beforeBreadcrumbs"}),", ",(0,o.jsx)(n.code,{children:"afterBreadcrumbs"}),", injections are set in list table, the table tries to shrink into viewport for better UX. In other words, in this default mode it moves scroll from body to the table itself:"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"alt text",src:t(2590).A+"",width:"3700",height:"2348"})}),"\n",(0,o.jsx)(n.p,{children:"However if one of the above injections is set, the table will not try to shrink it's height into viewport and will have a fixed height. We apply this behavior because generally page injection might take a lot of height and table risks to be too small to be usable. So vertical scroll is moved to the body (horizontal scroll is still on the table):"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"alt text",src:t(844).A+"",width:"3700",height:"2348"})}),"\n",(0,o.jsxs)(n.p,{children:["However, if you intend to use injection as a small panel, you can set ",(0,o.jsx)(n.code,{children:"meta.thinEnoughToShrinkTable"})," to ",(0,o.jsx)(n.code,{children:"true"})," in the injection instantiation:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",metastring:'title="/apartments.ts"',children:"{\n  resourceId: 'aparts',\n  ...\n  options: {\n    pageInjections: {\n      list: {\n        bottom: {\n          file: '@@/<ComponentForBottomPanel>.vue',\n          meta: {\n            thinEnoughToShrinkTable: true,\n          }\n        }\n      }\n    }\n  }\n}\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"alt text",src:t(786).A+"",width:"3700",height:"2348"})}),"\n",(0,o.jsxs)(n.p,{children:["If at least one injection will not set or will not define ",(0,o.jsx)(n.code,{children:"meta.thinEnoughToShrinkTable"})," as ",(0,o.jsx)(n.code,{children:"true"}),", the table will not try to shrink into viewport."]}),"\n",(0,o.jsx)(n.h2,{id:"three-dots-menu-customization",children:"Three dots menu customization"}),"\n",(0,o.jsx)(n.p,{children:"You can also inject custom components to the three dots menu on the top right corner of the page."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"alt text",src:t(2630).A+"",width:"3700",height:"2348"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",metastring:'title="/apartments.ts"',children:"{\n  resourceId: 'aparts',\n  ...\n  options: {\n    pageInjections: {\n      show: {\n          threeDotsDropdownItems: [\n            '@@/CheckReadingTime.vue',\n          ]\n      }\n    }\n  }\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Now create file ",(0,o.jsx)(n.code,{children:"CheckReadingTime.vue"})," in the ",(0,o.jsx)(n.code,{children:"custom"})," folder of your project:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-html",metastring:'title="./custom/CheckReadingTime.vue"',children:'<template>\n  <div class="text-gray-500 text-sm">\n    <div @click="checkReadingTime" class="cursor-pointer flex gap-2 items-center">\n      Check reading time\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { getReadingTime} from "text-analyzer";\nimport adminforth from \'@/adminforth\';\n\nfunction checkReadingTime() {\n  const text = document.querySelector(\'[data-af-column="description"]\')?.innerText;\n  if (text) {\n    const readingTime = getReadingTime(text);\n    adminforth.alert({\n      message: `Reading time: ${readingTime.minutes} minutes`,\n      variant: \'success\',\n    });\n  }\n  adminforth.list.closeThreeDotsDropdown();\n}\n<\/script>\n'})}),"\n",(0,o.jsx)(n.p,{children:"For this demo we will use text-analyzer package:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"cd custom\nnpm i text-analyzer\n"})}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["\u261d\ufe0f Please note that we are using AdminForth ",(0,o.jsx)(n.a,{href:"/docs/api/FrontendAPI/interfaces/FrontendAPIInterface/",children:"Frontend API"})," ",(0,o.jsx)(n.code,{children:"adminforth.list.closeThreeDotsDropdown();"})," to close the dropdown after the item is clicked."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"list-table-custom-action-icons",children:"List table custom action icons"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"customActionIcons"})," allows to add custom actions to the list page"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"alt text",src:t(5049).A+"",width:"3700",height:"2348"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",metastring:'title="/apartments.ts"',children:"{\n  resourceId: 'aparts',\n  ...\n  options: {\n    pageInjections: {\n      list: {\n          customActionIcons: [\n            '@@/SearchForApartmentInGoogle.vue',\n          ]\n      }\n    }\n  }\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Now create file ",(0,o.jsx)(n.code,{children:"SearchForApartmentInGoogle.vue"})," in the ",(0,o.jsx)(n.code,{children:"custom"})," folder of your project:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-html",metastring:'title="./custom/SearchForApartmentInGoogle.vue"',children:"<template>\n    <Tooltip>\n        <a :href=\"`https://google.com?q=${record.title}`\">\n            <IconCardSearch class=\"w-5 h-5 me-2\"/>\n        </a>\n\n        <template #tooltip>\n            {{$t('Search for competitive apartments in Google')}}\n        </template>\n    </Tooltip>\n</template>\n\n<script setup lang=\"ts\">\nimport { IconCardSearch } from '@iconify-prerendered/vue-mdi';\nimport Tooltip from '@/afcl/Tooltip.vue';\nimport type { AdminForthResourceColumnCommon, AdminForthResourceCommon, AdminUser } from '@/types/Common';\n\nconst props = defineProps<{\n  column: AdminForthResourceColumnCommon;\n  record: any;\n  meta: any;\n  resource: AdminForthResourceCommon;\n  adminUser: AdminUser\n}>();\n<\/script>\n"})}),"\n",(0,o.jsx)(n.p,{children:"Install used icon:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:"cd custom\nnpm i @iconify-prerendered/vue-mdi\n"})}),"\n",(0,o.jsx)(n.h2,{id:"global-injections",children:"Global Injections"}),"\n",(0,o.jsx)(n.p,{children:"You have opportunity to inject custom components to the global layout. For example, you can add a custom items into user menu"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"config.customization.globalInjections.userMenu"}),":"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"alt text",src:t(2708).A+"",width:"3700",height:"2348"})}),"\n",(0,o.jsxs)(n.p,{children:["use ",(0,o.jsx)(n.code,{children:"adminforth.closeUserMenuDropdown();"})," to close the dropdown after the item is clicked."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",metastring:'title="/index.ts"',children:"{\n  ...\n  customization: {\n    globalInjections: {\n      userMenu: [\n        '@@/CustomUserMenuItem.vue',\n      ]\n    }\n  }\n  ...\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Now create file ",(0,o.jsx)(n.code,{children:"CustomUserMenuItem.vue"})," in the ",(0,o.jsx)(n.code,{children:"custom"})," folder of your project:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-html",metastring:'title="./custom/CustomUserMenuItem.vue"',children:"<template>\n  <div @click=\"openCustomPage\" class=\"cursor-pointer flex px-4 py-2 text-sm flex items-center\">\n    Custom Page\n  </div>\n</template>\n\n<script setup>\nimport adminforth from '@/adminforth';\n\nfunction openCustomPage() {\n  adminforth.alert({\n    message: 'Custom page is opened',\n    variant: 'success',\n  });\n  adminforth.closeUserMenuDropdown();\n}\n<\/script>\n"})}),"\n",(0,o.jsx)(n.p,{children:"Also there are:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"config.customization.globalInjections.header"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"config.customization.globalInjections.sidebar"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"config.customization.globalInjections.everyPageBottom"})}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Unlike ",(0,o.jsx)(n.code,{children:"userMenu"}),", ",(0,o.jsx)(n.code,{children:"header"})," and ",(0,o.jsx)(n.code,{children:"sidebar"})," injections, ",(0,o.jsx)(n.code,{children:"everyPageBottom"})," will be added to the bottom of every page even when user is not logged in.\nYou can use it to execute some piece of code when any page is loaded. For example, you can add welcoming pop up when user visits a page."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",metastring:'title="/index.ts"',children:"{\n  ...\n  customization: {\n    globalInjections: {\n      userMenu: [\n        '@@/CustomUserMenuItem.vue',\n//diff-remove\n      ]\n//diff-add\n      ],\n//diff-add\n      everyPageBottom: [\n//diff-add\n        '@@/AnyPageWelcome.vue',\n//diff-add\n      ]\n    }\n  }\n  ...\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Now create file ",(0,o.jsx)(n.code,{children:"AnyPageWelcome.vue"})," in the ",(0,o.jsx)(n.code,{children:"custom"})," folder of your project:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-html",metastring:'title="./custom/AnyPageWelcome.vue"',children:"<template></template>\n\n<script setup>\nimport { onMounted } from 'vue';\nimport adminforth from '@/adminforth';\nonMounted(() => {\n  adminforth.alert({\n    message: 'Welcome!',\n    variant: 'success',\n  });\n});\n<\/script>\n"})})]})}function m(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},2590:(e,n,t)=>{t.d(n,{A:()=>o});const o=t.p+"assets/images/Group 15-8c64cba7036eb1531e06f1eafd0e1512.png"},844:(e,n,t)=>{t.d(n,{A:()=>o});const o=t.p+"assets/images/Group 17-fad9ca14c809d54bf230427a83660706.png"},786:(e,n,t)=>{t.d(n,{A:()=>o});const o=t.p+"assets/images/Group 19-0fe332102e0a7d77f9b1ae934c5a8099.png"},5049:(e,n,t)=>{t.d(n,{A:()=>o});const o=t.p+"assets/images/Group 3-44b6f2a38b402f3823bfa05fe80c8faa.png"},2630:(e,n,t)=>{t.d(n,{A:()=>o});const o=t.p+"assets/images/Group 4-2af3c4b75ad2094995919f1d80af2b17.png"},2708:(e,n,t)=>{t.d(n,{A:()=>o});const o=t.p+"assets/images/Group 6-892bd4a529ba37f695ef89f1e16135e5.png"},5694:(e,n,t)=>{t.d(n,{A:()=>o});const o=t.p+"assets/images/Page Injections-e83aebce2f7a171a638d09c3c29606ce.png"},1694:(e,n,t)=>{t.d(n,{A:()=>o});const o=t.p+"assets/images/loginPageInjection-8d19e0fb144a9386da9ddfca5cdc9463.png"},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>r});var o=t(6540);const i={},s=o.createContext(i);function a(e){const n=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);
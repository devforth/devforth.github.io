"use strict";(self.webpackChunkadminforth=self.webpackChunkadminforth||[]).push([[381],{168:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>s,metadata:()=>i,toc:()=>d});var a=t(4848),r=t(8453);const s={},o="Custom pages",i={id:"tutorial/Customization/customPages",title:"Custom pages",description:"Most Admin Panels should have some Dashboards or custom pages.",source:"@site/docs/tutorial/03-Customization/06-customPages.md",sourceDirName:"tutorial/03-Customization",slug:"/tutorial/Customization/customPages",permalink:"/docs/tutorial/Customization/customPages",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:6,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Disabling actions",permalink:"/docs/tutorial/Customization/limitingAccess"},next:{title:"Alerts and confirmations",permalink:"/docs/tutorial/Customization/alert"}},c={},d=[];function l(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h1,{id:"custom-pages",children:"Custom pages"}),"\n",(0,a.jsx)(n.p,{children:"Most Admin Panels should have some Dashboards or custom pages."}),"\n",(0,a.jsx)(n.p,{children:"In AdminForth creation of custom page is very simpl."}),"\n",(0,a.jsxs)(n.p,{children:["Install CHart.js library into your main package (near ",(0,a.jsx)(n.code,{children:"index.ts"}),"):"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"npm i vue-chartjs chart.js\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Create a Vue component in the ",(0,a.jsx)(n.code,{children:"custom"})," directory of your project, e.g. ",(0,a.jsx)(n.code,{children:"Dashboard.vue"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-vue",children:"\n<template>\n  <div>\n    <h1 class=\"mb-4 text-4xl font-extrabold text-gray-900 dark:text-white md:text-5xl lg:text-6xl\"><span class=\"text-transparent bg-clip-text bg-gradient-to-r to-emerald-600 from-sky-400\">The Appartments</span> Statistics.</h1>\n\n    <h2 class=\"mb-4 text-2xl font-extrabold leading-none tracking-tight text-gray-900 md:text-5xl lg:text-6xl dark:text-white\">Total square\n      by the <span class=\"underline underline-offset-3 decoration-8 decoration-blue-400 dark:decoration-blue-600\">class type</span>\n    </h2>\n\n    <Bar\n      :options=\"chart1Options\"\n      :data=\"chart1Data\"\n    />\n    <Bubble\n      :options=\"chart2Options\"\n      :data=\"chart2Data\"\n    />\n  </div>\n\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue';\nimport { Bar } from 'vue-chartjs'\nimport { Bubble } from 'vue-chartjs'\n\nimport { Chart as ChartJS, Title, Tooltip, Legend, BarElement, CategoryScale, LinearScale } from 'chart.js'\n\nChartJS.register(Title, Tooltip, Legend, BarElement, CategoryScale, LinearScale)\n\n\nconst chart1Data = ref({\n  labels: [].\n  datasets: []\n});\n\nconst chart1Options = {\n  responsive: true,\n  maintainAspectRatio: false,\n  scales: {\n    y: {\n      beginAtZero: true\n    }\n  }\n}\n\nconst chart2Data = ref({\n  labels: [].\n  datasets: []\n});\n\nconst chart2Options = {\n  responsive: true,\n  maintainAspectRatio: false,\n  scales: {\n    y: {\n      beginAtZero: true\n    }\n  }\n}\n\nonMounted(() => {\n  // Fetch data from the API\n  // and set it to the chartData\n  const resp = await fetch('/api/dashboard/');\n  const data = (await resp.json());\n\n  chartData.value.labels = data.map(d => d.squareByClassType.numberOfRooms);\n  chartData.value.datasets = [\n    {\n      label: 'Square meters',\n      data: data.map(d => d.squareMeters),\n      backgroundColor: 'rgba(54, 162, 235, 0.2)',\n      borderColor: 'rgba(54, 162, 235, 1)',\n      borderWidth: 1\n    },\n  ];\n\n  chart2Data.value.labels = data.map(d => d.numberOfRoomsPrice.numberOfRooms);\n\n})\n\n"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsxs)(n.p,{children:["\ud83e\udee8 use ",(0,a.jsx)(n.a,{href:"https://flowbite.com/",children:"https://flowbite.com/"})," to copy-paste pre-designed tailwind design blocks for your pages"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"You might notice that in mounted hook page fetches custom endpoint '/api/dashboard-stats'."}),"\n",(0,a.jsx)(n.p,{children:"We need to create this endpoint in the backend."}),"\n",(0,a.jsxs)(n.p,{children:["Open ",(0,a.jsx)(n.code,{children:"index.ts"})," file and add the following code:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"\n....\n// serve after you added all api\nadmin.express.serve(app, express)\nadmin.discoverDatabases();\n\n\napp.get('/api/dashboard/',\n  admin.express.authorize(\n    async (req, res) => {\n      const squareByClassType = await db.query(\n        'SELECT number_of_rooms as numberOfRooms, SUM(square_meters) as squareMeters FROM appartments GROUP BY number_of_rooms');\n\n      //get max and min price\n      const maxMinPrice = await db.query(\n        'SELECT MAX(price) as maxPrice, MIN(price) as minPrice FROM appartments');\n      \n      // divide price range into 10 buckets\n      const priceRange = (maxMinPrice.maxPrice - maxMinPrice.minPrice) / 10;\n\n      // generate data for bubble chart, where x is number of rooms, y is bucket of price range, and z is count of appartments\n      const numberOfRoomsPriceQuery = await db.query(\n        `SELECT number_of_rooms as numberOfRooms, \n                (price - ${maxMinPrice.minPrice}) / ${priceRange} as priceBucket \n                count(*) as count\n                GROUP BY numberOfRooms, priceBucket \n         FROM appartments`);\n      const numberOfRoomsPrice = bubbleDataQuery.map(row => {\n        row.priceRange = `${Math.round(row.priceBucket * priceRange)} - ${Math.round((row.priceBucket + 1) * priceRange)}`;\n      })\n\n\n      res.json({ squareByClassType, numberOfRoomsPrice });\n\n    }\n  )\n);\n\n"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsxs)(n.p,{children:["\ud83e\udee8 Please note that we are using ",(0,a.jsx)(n.code,{children:"admin.express.authorize"})," middleware to check if the user is logged in. If you want to make this endpoint public, you can remove this middleware. If user is not logged in, the request will return 401 Unauthorized status code, and protect our statistics from leak."]}),"\n"]}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsxs)(n.p,{children:["\ud83e\udee8 Moreover if you wrap your endpoint with ",(0,a.jsx)(n.code,{children:"admin.express.authorize"})," middleware, you can access ",(0,a.jsx)(n.code,{children:"req.adminUser"})," object in your endpoint to get the current user information."]}),"\n"]}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"\ud83e\udee8 AdminForth does not provide any facility to access data in database. You are free to use any ORM like Prisma, TypeORM, Sequelize,\nmongoose, or just use raw SQL queries against your tables."}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>i});var a=t(6540);const r={},s=a.createContext(r);function o(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);
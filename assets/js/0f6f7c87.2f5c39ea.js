"use strict";(self.webpackChunkadminforth=self.webpackChunkadminforth||[]).push([[1768],{9706:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>m,frontMatter:()=>a,metadata:()=>r,toc:()=>d});var o=t(4848),s=t(8453);const a={},i="Page Injections",r={id:"tutorial/Customization/pageInjections",title:"Page Injections",description:"In addition to ability to create custom pages and overwrite how fields are rendered, you can also inject custom components in standard AdminForth page.",source:"@site/docs/tutorial/03-Customization/08-pageInjections.md",sourceDirName:"tutorial/03-Customization",slug:"/tutorial/Customization/pageInjections",permalink:"/docs/tutorial/Customization/pageInjections",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:8,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Alerts and confirmations",permalink:"/docs/tutorial/Customization/alert"},next:{title:"Custom bulk actions",permalink:"/docs/tutorial/Customization/bulkActions"}},c={},d=[{value:"Login page customization",id:"login-page-customization",level:2},{value:"Three dots menu customization",id:"three-dots-menu-customization",level:2}];function l(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",img:"img",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{id:"page-injections",children:"Page Injections"}),"\n",(0,o.jsx)(n.p,{children:"In addition to ability to create custom pages and overwrite how fields are rendered, you can also inject custom components in standard AdminForth page."}),"\n",(0,o.jsxs)(n.p,{children:["For example let's add a custom pie chart to the ",(0,o.jsx)(n.code,{children:"list"})," page of the ",(0,o.jsx)(n.code,{children:"aparts"})," resource. Pie chart will show the distribution of the rooms count and more over will allow to filter the list by the rooms count."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",metastring:'title="./resources/apartments.ts"',children:"{\n  resourceId: 'aparts',\n  ...\n//diff-add\n  options: {\n//diff-add\n    pageInjections: {\n//diff-add\n      list: {\n//diff-add\n        afterBreadcrumbs: '@@/ApartsPie.vue',\n//diff-add\n      }\n//diff-add\n    }   \n//diff-add\n  }\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Now create file ",(0,o.jsx)(n.code,{children:"ApartsPie.vue"})," in the ",(0,o.jsx)(n.code,{children:"custom"})," folder of your project:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-html",metastring:'title="./custom/ApartsPie.vue"',children:'<template>\n  <div class="max-w-sm w-full bg-white rounded-lg shadow dark:bg-gray-800 p-4 md:p-4 mb-5">\n    <div id="pie-chart"></div>\n  </div>\n</template>\n\n<script setup lang="ts">\nimport { onMounted, ref, Ref } from \'vue\';\nimport ApexCharts from \'apexcharts\';\nimport { callApi } from \'@/utils\';\n\n\nconst data: Ref<any[]> = ref([]);\n\nconst POSSIBLE_COLORS = ["#1C64F2", "#16BDCA", "#9061F9", "#F0A936", "#F55252", "#3B82F6", "#10B981", "#F472B6", "#6B7280"];\n\nconst chatOptions = {\n  series: [],\n  colors: POSSIBLE_COLORS,\n  chart: {\n    height: 200,\n    width: "100%",\n    type: "pie",\n    events: {\n      dataPointSelection: function (event, chartContext, config) {\n        if (config.selectedDataPoints[0].length) {\n          const selectedRoomsCount = data.value[config.dataPointIndex].rooms;\n          window.adminforth.list.updateFilter({field: \'number_of_rooms\', operator: \'eq\', value: selectedRoomsCount});\n        } else {\n          // clear filter\n          window.adminforth.list.updateFilter({field: \'number_of_rooms\', value: undefined});\n        }\n      }\n    },\n  },\n\n  stroke: {\n    colors: ["white"],\n    lineCap: "",\n  },\n  plotOptions: {\n    pie: {\n      labels: {\n        show: true,\n      },\n      size: "100%",\n      dataLabels: {\n        offset: -25\n      }\n    },\n  },\n  labels: ["Direct", "Organic search", "Referrals"],\n  dataLabels: {\n    enabled: true,\n    style: {\n      fontFamily: "Inter, sans-serif",\n    },\n  },\n  legend: {\n    position: "right",\n    fontFamily: "Inter, sans-serif",\n  },\n  yaxis: {\n    labels: {\n      formatter: function (value) {\n        return value + "%"\n      },\n    },\n  },\n  xaxis: {\n    labels: {\n      formatter: function (value) {\n        return value  + "%"\n      },\n    },\n    axisTicks: {\n      show: false,\n    },\n    axisBorder: {\n      show: false,\n    },\n  }, \n}\n\nonMounted(async () => {\n  try {\n    data.value = await callApi({path: \'/api/aparts-by-room-percentages\', method: \'GET\'});\n  } catch (error) {\n    window.adminforth.alert({\n      message: `Error fetching data: ${error.message}`,\n      variant: \'danger\',\n      timeout: \'unlimited\'\n    });\n    return;\n  }\n\n  chatOptions.series = data.value.map((item) => item.percentage);\n  chatOptions.labels = data.value.map((item) => `${item.rooms} rooms`);\n  const chart = new ApexCharts(document.getElementById("pie-chart"), chatOptions);\n  chart.render();\n\n})\n\n<\/script>\n'})}),"\n",(0,o.jsxs)(n.p,{children:["Then initialize npm in ",(0,o.jsx)(n.code,{children:"custom"})," directory if you didn't do this and install required packages:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"npm init -y\nnpm install apexcharts --save-dev\n"})}),"\n",(0,o.jsx)(n.p,{children:"Also we have to add an Api to get percentages:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",metastring:'title="./index.ts"',children:"  app.get(`${ADMIN_BASE_URL}/api/aparts-by-room-percentages/`,\n    admin.express.authorize(\n      async (req, res) => {\n        const roomPercentages = await db.prepare(\n          `SELECT \n            number_of_rooms, \n            COUNT(*) as count \n          FROM apartments \n          GROUP BY number_of_rooms\n          ORDER BY number_of_rooms;\n          `\n        ).all();\n\n        const totalAparts = roomPercentages.reduce((acc, { count }) => acc + count, 0);\n\n        res.json(\n          roomPercentages.map(\n            ({ number_of_rooms, count }) => ({\n              rooms: number_of_rooms,\n              percentage: Math.round(count / totalAparts * 100),\n            })\n          )\n        );\n      }\n    )\n  );\n\n  // serve after you added all api\n  admin.discoverDatabases();\n  admin.express.serve(app)\n"})}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["\u261d\ufe0f Please note that we are using ",(0,o.jsx)(n.code,{children:"window.adminforth.list.updateFilter({field: 'number_of_rooms', operator: 'eq', value: selectedRoomsCount});"})," to set filter when we are located on apartments list page"]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Here is how it looks:\n",(0,o.jsx)(n.img,{alt:"alt text",src:t(2711).A+"",width:"3700",height:"2348"})]}),"\n",(0,o.jsx)(n.h2,{id:"login-page-customization",children:"Login page customization"}),"\n",(0,o.jsx)(n.p,{children:"You can also inject custom components to the login page."}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"loginPageInjections.underInputs"})," allows to add one or more panels under the login form inputs:"]}),"\n",(0,o.jsx)("img",{src:"/assets/images/image-15.png",width:"400",alt:"loginPageInjections.underInputs"}),"\n",(0,o.jsx)(n.p,{children:"For example:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",metastring:'title="/index.ts"',children:"\nnew AdminForth({\n  ...\n  customization: {\n    loginPageInjections: {\n      underInputs: '@@/CustomLoginFooter.vue',\n    }\n    ...\n  }\n\n  ...\n})\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Now create file ",(0,o.jsx)(n.code,{children:"CustomLoginFooter.vue"})," in the ",(0,o.jsx)(n.code,{children:"custom"})," folder of your project:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-html",metastring:'title="./custom/CustomLoginFooter.vue"',children:'<template>\n  <div class="text-center text-gray-500 text-sm mt-4">\n    By logging in, you agree to our <a href="#" class="text-blue-500">Terms of Service</a> and <a href="#" class="text-blue-500">Privacy Policy</a>\n  </div>\n</template>\n'})}),"\n",(0,o.jsx)(n.h2,{id:"three-dots-menu-customization",children:"Three dots menu customization"}),"\n",(0,o.jsx)(n.p,{children:"You can also inject custom components to the three dots menu on the top right corner of the page."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",metastring:'title="/apartments.ts"',children:"{\n  resourceId: 'aparts',\n  ...\n  options: {\n    pageInjections: {\n      show: {\n          threeDotsDropdownItems: [\n            '@@/CheckReadingTime.vue',\n          ]\n      }\n    }\n  }\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Now create file ",(0,o.jsx)(n.code,{children:"CheckReadingTime.vue"})," in the ",(0,o.jsx)(n.code,{children:"custom"})," folder of your project:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-html",metastring:'title="./custom/CheckReadingTime.vue"',children:'<template>\n  <div class="text-gray-500 text-sm">\n    <div @click="checkReadingTime" class="cursor-pointer flex gap-2 items-center">\n      Check reading time\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { getReadingTime} from "text-analyzer";\n\nfunction checkReadingTime() {\n  const text = document.querySelector(\'[data-af-column="description"]\')?.innerText;\n  if (text) {\n    const readingTime = getReadingTime(text);\n    window.adminforth.alert({\n      message: `Reading time: ${readingTime} minutes`,\n      variant: \'success\',\n    });\n  }\n  window.adminforth.list.closeThreeDotsDropdown();\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"For this demo we will use text-analyzer package:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"cd custom\nnpm install text-analyzer --save\n"})}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["\u261d\ufe0f Please note that we are using AdminForth Frontend API ",(0,o.jsx)(n.code,{children:"window.adminforth.list.closeThreeDotsDropdown();"})," to close the dropdown after the item is clicked."]}),"\n"]})]})}function m(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},2711:(e,n,t)=>{t.d(n,{A:()=>o});const o=t.p+"assets/images/Page Injections-63526d614922069cce25bab1291ed56e.png"},8453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>r});var o=t(6540);const s={},a=o.createContext(s);function i(e){const n=o.useContext(a);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),o.createElement(a.Provider,{value:n},e.children)}}}]);
"use strict";(self.webpackChunkadminforth=self.webpackChunkadminforth||[]).push([[52],{57828:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"tutorial/Plugins/TwoFactorsAuth","title":"Two-Factor Authentication Plugin","description":"The Two-Factor Authentication Plugin provides an additional layer of security to the application by requiring users to provide a second form of authentication in addition to their password. This plugin supports  authenticator apps.","source":"@site/docs/tutorial/07-Plugins/02-TwoFactorsAuth.md","sourceDirName":"tutorial/07-Plugins","slug":"/tutorial/Plugins/TwoFactorsAuth","permalink":"/docs/tutorial/Plugins/TwoFactorsAuth","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"AuditLog","permalink":"/docs/tutorial/Plugins/AuditLog"},"next":{"title":"ForeignInlineList","permalink":"/docs/tutorial/Plugins/ForeignInlineList"}}');var a=t(74848),s=t(28453);const r={},o="Two-Factor Authentication Plugin",d={},c=[{value:"Installation",id:"installation",level:2},{value:"Disabling Two-Factor Authentication locally",id:"disabling-two-factor-authentication-locally",level:2},{value:"Select which users should use Two-Factor Authentication",id:"select-which-users-should-use-two-factor-authentication",level:2},{value:"Allow Specific Users to Skip Two-Factor Authentication Setup",id:"allow-specific-users-to-skip-two-factor-authentication-setup",level:2},{value:"Request 2FA on custom Actions",id:"request-2fa-on-custom-actions",level:2},{value:"Request 2FA for create/edit (secure save gating)",id:"request-2fa-for-createedit-secure-save-gating",level:2},{value:"Request 2FA from custom components",id:"request-2fa-from-custom-components",level:2},{value:"Custom label prefix in authenticator app",id:"custom-label-prefix-in-authenticator-app",level:2},{value:"Passkeys setup",id:"passkeys-setup",level:2}];function l(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"two-factor-authentication-plugin",children:"Two-Factor Authentication Plugin"})}),"\n",(0,a.jsx)(n.p,{children:"The Two-Factor Authentication Plugin provides an additional layer of security to the application by requiring users to provide a second form of authentication in addition to their password. This plugin supports  authenticator apps."}),"\n",(0,a.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"npm i @adminforth/two-factors-auth --save\n"})}),"\n",(0,a.jsx)(n.p,{children:"Plugin is already installed into adminforth, to import:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",metastring:'title="/adminuser.ts"',children:"import TwoFactorsAuthPlugin from '@adminforth/two-factors-auth';\n"})}),"\n",(0,a.jsx)(n.p,{children:"Plugin required some additional setup, to make it work properly. It should be added to the resource auth resource. In our example we will add it to the user resource ."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",metastring:"title='./schema.prisma'",children:"model adminuser {\n  id            String     @id\n  created_at    DateTime\n  email         String   @unique\n  role          String\n  password_hash String\n//diff-add\n  secret2fa     String?\n}\n"})}),"\n",(0,a.jsx)(n.p,{children:"Then:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"npm run makemigration -- --name add-2fa-secret ; npm run migrate:local\n\n\n"})}),"\n",(0,a.jsxs)(n.p,{children:["And add it to ",(0,a.jsx)(n.code,{children:"adminuser.ts"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",metastring:'tittle="./resources/adminuser.ts"',children:"{\n    table: 'adminuser',\n//diff-add\n    plugins: [\n//diff-add\n        new TwoFactorsAuthPlugin ({ twoFaSecretFieldName: 'secret2fa', timeStepWindow: 1 }),\n//diff-add\n    ],\n    columns: [\n        ...\n//diff-add\n        {\n//diff-add\n            name: 'secret2fa',\n//diff-add\n            showIn: { all: false },\n//diff-add\n            backendOnly: true,\n//diff-add\n        }\n    ],\n  }\n"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsxs)(n.p,{children:["\ud83d\udca1 ",(0,a.jsx)(n.strong,{children:"Note"}),": Time-Step Size"]}),"\n",(0,a.jsxs)(n.p,{children:["By default, ",(0,a.jsx)(n.code,{children:"timeStepWindow"})," is set to ",(0,a.jsx)(n.code,{children:"1"}),", which means the Two-Factor Authentication Plugin will check the current 30-second time-step, as well as one step before and after, to validate a TOTP code. This aligns with ",(0,a.jsx)(n.a,{href:"https://www.rfc-editor.org/rfc/rfc6238",children:"RFC 6238"})," best practices to accommodate slight clock drift between the server and the user's device."]}),"\n",(0,a.jsxs)(n.p,{children:["For example, if a code is generated between ",(0,a.jsx)(n.strong,{children:"12:00:00"})," and ",(0,a.jsx)(n.strong,{children:"12:00:30"}),", it will typically expire at ",(0,a.jsx)(n.strong,{children:"12:00:30"}),". However, with a ",(0,a.jsx)(n.code,{children:"timeStepWindow"})," of ",(0,a.jsx)(n.code,{children:"1"}),", the plugin will continue to accept it up to ",(0,a.jsx)(n.strong,{children:"12:00:59"})," (the \u201cnext\u201d 30-second step), preventing users from being locked out if their device clock is a few seconds off. Once the clock hits ",(0,a.jsx)(n.strong,{children:"12:01:00"}),", that previous code will be treated as expired."]}),"\n",(0,a.jsxs)(n.p,{children:["If you find users frequently encountering code mismatches due to clock drift, you can increase ",(0,a.jsx)(n.code,{children:"timeStepWindow"})," to ",(0,a.jsx)(n.code,{children:"2"}),". ",(0,a.jsx)(n.strong,{children:"However, be cautious: larger windows can reduce overall security!"})]}),"\n",(0,a.jsxs)(n.p,{children:["\u2757 With a ",(0,a.jsx)(n.code,{children:"timeStepWindow"})," set to ",(0,a.jsx)(n.code,{children:"0"}),", the plugin will pass all the expired codes, which is not secure and should only be used for testing purposes."]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["Thats it! Two-Factor Authentication is now enabled:\n",(0,a.jsx)(n.img,{alt:"alt text",src:t(14847).A+"",width:"3700",height:"1932"})]}),"\n",(0,a.jsx)(n.h2,{id:"disabling-two-factor-authentication-locally",children:"Disabling Two-Factor Authentication locally"}),"\n",(0,a.jsxs)(n.p,{children:["If it is not convenient to enter the code every time you log in during local development, you can disable Two-Factor Authentication\nfor the dev environment using ",(0,a.jsx)(n.code,{children:"usersFilterToApply"})," option."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",metastring:"title='./index.ts'",children:"\n    plugins: [\n        new TwoFactorsAuthPlugin ({\n          twoFaSecretFieldName: 'secret2fa',\n//diff-add\n          usersFilterToApply: (adminUser: AdminUser) => {\n//diff-add\n            // if this method returns true, 2FA will be enforced for this user, if returns false - 2FA will be disabled\n//diff-add\n            if (process.env.NODE_ENV === 'development') {\n//diff-add\n              return false;\n//diff-add\n            }\n//diff-add\n            return true;\n//diff-add\n          },\n        }),\n    ],\n"})}),"\n",(0,a.jsx)(n.h2,{id:"select-which-users-should-use-two-factor-authentication",children:"Select which users should use Two-Factor Authentication"}),"\n",(0,a.jsx)(n.p,{children:"By default plugin enforces Two-Factor Authentication for all users."}),"\n",(0,a.jsxs)(n.p,{children:["If you wish to enforce 2FA only for specific users, you can again use ",(0,a.jsx)(n.code,{children:"usersFilterToApply"})," option:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",metastring:"title='./adminuser.ts'",children:"  usersFilterToApply: (adminUser: AdminUser) => {\n    // disable 2FA for users which email is 'adminforth' or 'adminguest'\n    return !(['adminforth', 'adminguest'].includes(adminUser.dbUser.email));\n  },\n"})}),"\n",(0,a.jsx)(n.p,{children:"You can even add a boolean column to the user table to store whether the user should use 2FA or not:"}),"\n",(0,a.jsxs)(n.p,{children:["In ",(0,a.jsx)(n.code,{children:"schema.prisma"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",metastring:"title='./schema.prisma'",children:"model adminuser {\n  id            String     @id\n  created_at    DateTime\n  email         String   @unique\n  role          String\n  password_hash String\n  secret2fa     String?\n//diff-add\n  use2fa        Boolean?  @default(false)\n}\n"})}),"\n",(0,a.jsx)(n.p,{children:"Then run:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"npm run makemigration -- --name add-use2fa ; npm run migrate:local\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Then in ",(0,a.jsx)(n.code,{children:"adminuser.ts"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",metastring:"title='./adminuser.ts'",children:"{\n    resourceId: 'adminuser',\n    ...\n    columns: [\n        ...\n        {\n            name: 'use2fa',\n        }\n        ...\n    ],\n    options: {\n      allowedActions: {\n        delete: async ({ adminUser }: { adminUser: AdminUser }) => {\n          // only superadmin can delete users\n          return adminUser.dbUser.role === 'superadmin';\n        },\n        create: async ({ adminUser }: { adminUser: AdminUser }) => {\n          // only superadmin can create users\n          return adminUser.dbUser.role === 'superadmin';\n        },\n        edit: async ({ adminUser, meta }: { adminUser: AdminUser }) => {\n          // user can modify only his own record\n          const { oldRecord } = meta;\n          return adminUser.dbUser.id === oldRecord.id;\n        },\n      }\n    },\n    plugins: [\n        new TwoFactorsAuthPlugin ({\n          twoFaSecretFieldName: 'secret2fa',\n          usersFilterToApply: (adminUser: AdminUser) => {\n            return adminUser.dbUser.use2fa;\n          },\n        }),\n    ],\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"allow-specific-users-to-skip-two-factor-authentication-setup",children:"Allow Specific Users to Skip Two-Factor Authentication Setup"}),"\n",(0,a.jsx)(n.p,{children:"By default, all users are required to setup Two-Factor Authentication if it is enabled."}),"\n",(0,a.jsxs)(n.p,{children:["If you want to allow specific users to ",(0,a.jsx)(n.strong,{children:"skip"})," the 2FA setup, you can use the ",(0,a.jsx)(n.code,{children:"usersFilterToAllowSkipSetup"})," option:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",metastring:"title='./adminuser.ts'",children:"...\nplugins: [\n        new TwoFactorsAuthPlugin ({\n          twoFaSecretFieldName: 'secret2fa',\n          ...\n        //diff-add\n          usersFilterToAllowSkipSetup: (adminUser: AdminUser) => {\n            //diff-add\n            // allow skip setup 2FA for users which email is 'adminforth' or 'adminguest'\n            //diff-add\n            return (['adminforth', 'adminguest'].includes(adminUser.dbUser.email));\n            //diff-add\n          },\n        }),\n],\n...\n"})}),"\n",(0,a.jsx)(n.h2,{id:"request-2fa-on-custom-actions",children:"Request 2FA on custom Actions"}),"\n",(0,a.jsx)(n.p,{children:"You might want to to allow to call some custom critical/money related actions with additional 2FA approval. This eliminates risks caused by user cookies theft by some virous/doorway software after login."}),"\n",(0,a.jsxs)(n.p,{children:["To do it, first, create frontend custom component which wraps and intercepts click event to menu item, and in click handler do a call to ",(0,a.jsx)(n.code,{children:"window.adminforthTwoFaModal.getCode(cb?)"})," frontend API exposed by this plugin. This is awaitable call wich shows 2FA popup and asks user to authenticate with 2nd factor (if passkey is enabled it will be suggested first, with ability to fallback to TOTP)"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",metastring:"title='/custom/RequireTwoFaGate.vue'",children:'<template>\n  <div class="contents" @click.stop.prevent="onClick">\n    <slot />  \x3c!-- render action default content - button/icon --\x3e\n  </div>\n</template>\n\n<script setup lang="ts">\n  const emit = defineEmits<{ (e: \'callAction\', payload?: any): void }>();\n  const props = defineProps<{ disabled?: boolean; meta?: Record<string, any> }>();\n\n  async function onClick() {\n    if (props.disabled) return;\n  \n  const verificationResult = await window.adminforthTwoFaModal.get2FaConfirmationResult();  // this will ask user to enter code\n    emit(\'callAction\', { verificationResult }); // then we pass this verification result to action (from fronted to backend)\n  }\n<\/script>\n'})}),"\n",(0,a.jsx)(n.p,{children:"Now we need to use verification result  which we got from user on frontend, inside of backend action handler and verify that it is valid (and not expired):"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",metastring:"title='/adminuser.ts'",children:"options: {\n  actions: [\n    {\n      name: 'Auto submit',\n      icon: 'flowbite:play-solid',\n      allowed: () => true,\n      action: async ({ recordId, adminUser, adminforth, extra, cookies }) => {\n        //diff-add\n        const verificationResult = extra?.verificationResult\n        //diff-add\n        if (!verificationResult) {\n          //diff-add\n          return { ok: false, error: 'No verification result provided' };\n        //diff-add\n        }\n        //diff-add\n        const t2fa = adminforth.getPluginByClassName<TwoFactorsAuthPlugin>('TwoFactorsAuthPlugin');\n        //diff-add\n        const result = await t2fa.verify(verificationResult, {\n        //diff-add\n          adminUser: adminUser,\n        //diff-add\n          userPk: adminUser.pk,\n        //diff-add\n          cookies: cookies\n        //diff-add\n        });\n\n        //diff-add\n        if (!result?.ok) {\n          //diff-add\n          return { ok: false, error: result?.error ?? 'Provided 2fa verification data is invalid' };\n          //diff-add\n        }\n        //diff-add\n        await adminforth\n        //diff-add\n          .getPluginByClassName<AuditLogPlugin>('AuditLogPlugin')\n          //diff-add\n          .logCustomAction({\n            //diff-add\n            resourceId: 'aparts',\n            //diff-add\n            recordId: null,\n            //diff-add\n            actionId: 'visitedDashboard',\n            //diff-add\n            oldData: null,\n            //diff-add\n            data: { dashboard: 'main' },\n            //diff-add\n            user: adminUser,\n            //diff-add\n          });\n\n          //your critical action logic \n      \n        return { ok: true, successMessage: 'Auto submitted' };\n      },\n      showIn: { showButton: true, showThreeDotsMenu: true, list: true },\n      //diff-add\n      customComponent: '@@/RequireTwoFaGate.vue',\n    },\n  ],\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"request-2fa-for-createedit-secure-save-gating",children:"Request 2FA for create/edit (secure save gating)"}),"\n",(0,a.jsx)(n.p,{children:"To protect create and edit operations, collect the result of the 2FA modal on the frontend and send it along with the save payload. The server must verify it before writing changes."}),"\n",(0,a.jsx)(n.p,{children:"Frontend (custom Save button example):"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-vue",children:"<template>\n  <button :disabled=\"disabled || saving || !isValid\" @click=\"onClick\">Save</button>\n  \x3c!-- The plugin injects TwoFAModal globally, exposing window.adminforthTwoFaModal --\x3e\n</template>\n\n<script setup lang=\"ts\">\nconst props = defineProps<{\n  disabled: boolean;\n  saving: boolean;\n  isValid: boolean;\n  // saveRecord accepts optional meta with confirmationResult\n  saveRecord: (opts?: { confirmationResult?: any }) => Promise<void>;\n  meta?: any;\n}>();\n\nasync function onClick() {\n  if (props.disabled || props.saving || !props.isValid) return;\n  const modal = (window as any)?.adminforthTwoFaModal;\n  if (modal?.get2FaConfirmationResult) {\n    const confirmationResult = await modal.get2FaConfirmationResult(undefined, props.meta?.twoFaTitle || 'Confirm to save changes');\n    await props.saveRecord({ confirmationResult });\n  } else {\n    const code = window.prompt('Enter your 2FA code to proceed');\n    if (!code) return;\n    await props.saveRecord({ confirmationResult: { mode: 'totp', result: code } });\n  }\n}\n<\/script>\n"})}),"\n",(0,a.jsx)(n.p,{children:"Backend (resource hook verification):"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"// Inside resource config\nhooks: {\n  edit: {\n    beforeSave: async ({ adminUser, adminforth, extra }) => {\n      const t2fa = adminforth.getPluginByClassName('TwoFactorsAuthPlugin');\n      const confirmationResult = extra?.body?.meta?.confirmationResult;\n      if (!confirmationResult) {\n        return { ok: false, error: 'Two-factor authentication confirmation result is missing' };\n      }\n      const cookies = extra?.cookies;\n      const verifyRes = await t2fa.verify(confirmationResult, {\n        adminUser,\n        userPk: adminUser.pk,\n        cookies,\n      });\n      if (!('ok' in verifyRes) || verifyRes.ok !== true) {\n        return { ok: false, error: verifyRes?.error || 'Two-factor authentication failed' };\n      }\n      return { ok: true };\n    },\n  },\n}\n"})}),"\n",(0,a.jsx)(n.p,{children:"This approach ensures 2FA cannot be bypassed by calling the API directly:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["The client collects verification via the modal and forwards it under ",(0,a.jsx)(n.code,{children:"meta.confirmationResult"}),"."]}),"\n",(0,a.jsxs)(n.li,{children:["The server validates it in ",(0,a.jsx)(n.code,{children:"beforeSave"})," with access to ",(0,a.jsx)(n.code,{children:"extra.cookies"})," and the ",(0,a.jsx)(n.code,{children:"adminUser"}),"."]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"request-2fa-from-custom-components",children:"Request 2FA from custom components"}),"\n",(0,a.jsx)(n.p,{children:"Imagine you have some button which does some API call"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"<template>\n  <Button @click=\"callAdminAPI\">Call critical API</Button>\n</template>\n  \n\n<script setup lang=\"ts\">\nimport { callApi } from '@/utils';\nimport adminforth from '@/adminforth';\n\nasync function callAdminAPI() {\n  const verificationResult = await window.adminforthTwoFaModal.get2FaConfirmationResult();\n\n  const res = await callApi({\n    path: '/myCriticalAction',\n    method: 'POST',\n    body: {\n      param: 1\n    },\n  });\n}\n<\/script>\n"})}),"\n",(0,a.jsx)(n.p,{children:"On backend you have simple express api"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"app.post(`${ADMIN_BASE_URL}/myCriticalAction`,\n  admin.express.authorize(\n    async (req: any, res: any) => {\n\n      // ... your critical logic ...\n\n      return res.json({ ok: true, successMessage: 'Action executed' });\n    }\n  )\n);\n"})}),"\n",(0,a.jsx)(n.p,{children:"You might want to protect this call with a second factor also. To do it, we need to make this change"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"<template>\n  <Button @click=\"callAdminAPI\">Call critical API</Button>\n</template>\n  \n\n<script setup lang=\"ts\">\nimport { callApi } from '@/utils';\nimport adminforth from '@/adminforth';\n\nasync function callAdminAPI() {\n  // diff-add\n  const verificationResult = await window.adminforthTwoFaModal.get2FaConfirmationResult();\n\n  const res = await callApi({\n    path: '/myCriticalAction',\n    method: 'POST',\n    body: {\n      param: 1,\n  // diff-add\n      verificationResult: String(verificationResult)\n    },\n  });\n\n  // diff-add\n  if (!res?.ok) {\n  // diff-add\n    adminforth.alert({ message: res.error, variant: 'danger' });\n  // diff-add\n  }\n}\n<\/script>\n\n"})}),"\n",(0,a.jsx)(n.p,{children:"And oin API call we need to verify it:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"app.post(`${ADMIN_BASE_URL}/myCriticalAction`,\n  admin.express.authorize(\n    async (req: any, res: any) => {\n\n      // diff-add\n      const { adminUser } = req;\n      // diff-add\n      const { param, verificationResult } = req.body ?? {};\n      // diff-add\n      const t2fa = admin.getPluginByClassName<TwoFactorsAuthPlugin>('TwoFactorsAuthPlugin');\n      // diff-add\n      const verifyRes = await t2fa.verify(verificationResult, {\n      // diff-add\n        adminUser: adminUser,\n      // diff-add\n        userPk: adminUser.pk,\n      // diff-add\n        cookies: cookies\n      // diff-add\n      });\n      // diff-add\n      if (!('ok' in verifyRes)) {\n      // diff-add\n        return res.status(400).json({ ok: false, error: verifyRes.error || 'Verification failed' });\n      // diff-add\n      }\n      // diff-add\n      await admin.getPluginByClassName<AuditLogPlugin>('AuditLogPlugin').logCustomAction({\n      // diff-add\n        resourceId: 'aparts',\n      // diff-add\n        recordId: null,\n      // diff-add\n        actionId: 'myCriticalAction',\n      // diff-add\n        oldData: null,\n      // diff-add\n        data: { param },\n      // diff-add\n        user: adminUser,\n      // diff-add\n      });\n\n      // ... your critical logic ...\n\n      return res.json({ ok: true, successMessage: 'Action executed' });\n    }\n  )\n);\n"})}),"\n",(0,a.jsx)(n.h2,{id:"custom-label-prefix-in-authenticator-app",children:"Custom label prefix in authenticator app"}),"\n",(0,a.jsxs)(n.p,{children:["By default label prefix in Authenticator app is formed from Adminforth ",(0,a.jsx)(n.a,{href:"/docs/tutorial/Customization/branding/",children:"brandName setting"}),' which is best behaviour for most admin apps (always remember to configure brandName correctly e.g. "RoyalFinTech Admin")\nIf you want to have custom label prefix for some reason:']}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",metastring:'label="./adminuser"',children:"  plugins: [\n    new TwoFactorsAuthPlugin ({\n      twoFaSecretFieldName: 'secret2fa',\n        ...\n      customBrandPrefix: \"TechStore\",\n    }),\n  ],\n"})}),"\n",(0,a.jsx)(n.h2,{id:"passkeys-setup",children:"Passkeys setup"}),"\n",(0,a.jsx)(n.p,{children:"If you want to use both passkeys and TOTP simultaneously, you can set them up as follows:"}),"\n",(0,a.jsx)(n.p,{children:"First, you need to create a passkeys table in your schema.prisma file:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",metastring:"title='./schema.prisma'",children:"  //diff-add\n  model passkeys {\n    //diff-add\n    id                      String @id\n    //diff-add\n    credential_id           String  \n    //diff-add\n    user_id                 String\n    //diff-add\n    meta                    String\n    //diff-add\n    @@index([user_id])\n    //diff-add\n    @@index([credential_id])\n    //diff-add\n  }\n"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"\u261d\ufe0fUse string data type for credential_id and meta fields"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"And make migration:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"npm run makemigration -- --name add-passkeys ; npm run migrate:local\n"})}),"\n",(0,a.jsx)(n.p,{children:"Next, you need to create a new resource for passkeys:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",metastring:"title='./resources/passkeys.ts'",children:"  import { AdminForthDataTypes, AdminForthResourceInput } from \"adminforth\";\n  import { randomUUID } from \"crypto\";\n\n  export default {\n    dataSource: 'maindb',\n    table: 'passkeys',\n    resourceId: 'passkeys',\n    label: 'Passkeys',\n    columns: [\n      {\n        name: 'id',\n        label: 'ID',\n        primaryKey: true,\n        showIn: { all: false},\n        fillOnCreate: () => randomUUID(),\n      },\n      {\n        name: 'credential_id',\n        label: 'Credential ID',\n      },\n      {\n        name: 'user_id',\n        label: 'User ID',\n      },\n      {\n        name: \"meta\",\n        type: AdminForthDataTypes.JSON,\n        label: \"Meta\",\n      }\n    ],\n    plugins: [],\n    options: {},\n  } as AdminForthResourceInput;\n"})}),"\n",(0,a.jsx)(n.p,{children:"Add the new resource to index.ts:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",metastring:"title='./index.ts'",children:"    ...\n  //diff-add\n  import passkeysResource from './resources/passkeys.js';\n    ...\n\n  resources: [\n    ...\n    //diff-add\n    passkeysResource,\n    ...\n  ],\n"})}),"\n",(0,a.jsx)(n.p,{children:"Now, update the settings of the Two-Factor Authentication plugin:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",metastring:"tittle='./resources/adminuser.ts'",children:'  plugins: [\n    new TwoFactorsAuthPlugin ({ \n      twoFaSecretFieldName: \'secret2fa\', \n      timeStepWindow: 1,       \n      //diff-add\n      passkeys: {\n        //diff-add\n        credentialResourceID: "passkeys",\n        //diff-add\n        credentialIdFieldName: "credential_id",\n        //diff-add\n        credentialMetaFieldName: "meta",\n        //diff-add\n        credentialUserIdFieldName: "user_id",\n        //diff-add\n        settings: {\n          // diff-add\n          expectedOrigin: "http://localhost:3500",   // important, set it to your backoffice origin (starts from scheme, no slash at the end)\n          //diff-add\n          // relying party config\n          //diff-add\n          rp: {\n              //diff-add\n              name: "New Reality",\n              \n              //diff-add\n              // optionaly you can set expected id explicitly if you need to:\n              //diff-add\n              // id: "localhost",\n              //diff-add\n            },\n            //diff-add\n            user: {\n              //diff-add\n                nameField: "email",\n                //diff-add\n                displayNameField: "email",\n                //diff-add\n            },\n            //diff-add\n            authenticatorSelection: {\n              // diff-add\n              // impacts a way how passkey will be created\n              // diff-add\n              // - platform - using browser internal authenticator (e.g. Google Chrome passkey / Google Password Manager )\n              // diff-add\n              // - cross-platform - using external authenticator (e.g. Yubikey, Google Titan etc)\n              // diff-add\n              // - both - plging will show both options to the user\n              // diff-add\n              // Can be "platform", "cross-platform" or "both"\n              // diff-add\n                authenticatorAttachment: "both",\n                //diff-add\n                requireResidentKey: true,\n                //diff-add\n                userVerification: "required",\n                //diff-add\n            },\n            //diff-add\n        },\n        //diff-add\n      } \n    }),\n  ],\n'})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsxs)(n.p,{children:["\u261d\ufe0f most likely you should set ",(0,a.jsx)(n.code,{children:"passkeys.settings.expectedOrigin"})," from your process.env depending on your env (e.g. ",(0,a.jsx)(n.a,{href:"http://localhost:3500",children:"http://localhost:3500"})," for local dev, ",(0,a.jsx)(n.a,{href:"https://admin.yourproduct.com",children:"https://admin.yourproduct.com"})," for production etc)"]}),"\n"]}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsxs)(n.p,{children:["\ud83d\udca1",(0,a.jsx)(n.strong,{children:"Note"})," By default ",(0,a.jsx)(n.code,{children:"passkeys.settings.rp.id"})," is generated from the expectedOrigin so you don't need to set it\nunless you know what you are doing. Manual setting might be needed for sub-domains isolation.\nBy default, if you set expected origin to ",(0,a.jsx)(n.a,{href:"https://localhost:3500",children:"https://localhost:3500"}),' it will use "localhost" as rpid\nIf you set origin to ',(0,a.jsx)(n.a,{href:"https://myadmin.myproduct.com",children:"https://myadmin.myproduct.com"}),' -> it will use  "myadmin.myproduct.com"  as rpid']}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"The setup is complete. To create a passkey:"}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"Go to the user menu"}),"\n",(0,a.jsx)(n.li,{children:"Click settings"}),"\n",(0,a.jsx)(n.li,{children:'Select "passkeys"'}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"alt text",src:t(26326).A+"",width:"184",height:"274"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsxs)(n.ol,{start:"4",children:["\n",(0,a.jsx)(n.li,{children:"Add passkey"}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"alt text",src:t(56653).A+"",width:"1007",height:"454"})}),"\n",(0,a.jsx)(n.p,{children:"After adding passkey you can use passkey, instead of TOTP:"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"alt text",src:t(2756).A+"",width:"1636",height:"862"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsxs)(n.p,{children:["\ud83d\udca1 ",(0,a.jsx)(n.strong,{children:"Note"}),": Adding a passkey does not remove the option to use TOTP. If you lose access to your passkey, you can log in using TOTP and reset your passkey."]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},26326:(e,n,t)=>{t.d(n,{A:()=>i});const i="data:image/png;base64,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"},56653:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/Passkeys2-31bf883c97e783e4caa9e6742c453d55.png"},2756:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/Passkeys3-edf55e33b6bdf96d82c52d60ff1b2eda.png"},14847:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/image-1-1aa4ed0aa37a198c7c9e14c981db42dd.png"},28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>o});var i=t(96540);const a={},s=i.createContext(a);function r(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);
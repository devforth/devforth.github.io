"use strict";(self.webpackChunkadminforth=self.webpackChunkadminforth||[]).push([[5309],{4663:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"tutorial/Customization/Actions","title":"Actions","description":"You might need to give admin users a feature to perform some action on a single record. Actions can be displayed as buttons in the list view and/or in the three-dots menu.","source":"@site/docs/tutorial/03-Customization/14-Actions.md","sourceDirName":"tutorial/03-Customization","slug":"/tutorial/Customization/Actions","permalink":"/docs/tutorial/Customization/Actions","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":14,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Standard pages tuning","permalink":"/docs/tutorial/Customization/standardPagesTuning"},"next":{"title":"AdminForth Components Library","permalink":"/docs/tutorial/Customization/afcl"}}');var o=t(4848),i=t(8453);const r={},a="Actions",c={},l=[{value:"Action Configuration Options",id:"action-configuration-options",level:2},{value:"Access Control",id:"access-control",level:2},{value:"Action URL",id:"action-url",level:2}];function d(n){const e={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.header,{children:(0,o.jsx)(e.h1,{id:"actions",children:"Actions"})}),"\n",(0,o.jsx)(e.p,{children:"You might need to give admin users a feature to perform some action on a single record. Actions can be displayed as buttons in the list view and/or in the three-dots menu."}),"\n",(0,o.jsx)(e.p,{children:"Here's how to add a custom action:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-ts",metastring:'title="./resources/apartments.ts"',children:"{\n  resourceId: 'aparts',\n  options: {\n    actions: [\n      {\n        name: 'Auto submit',  // Display name of the action\n        icon: 'flowbite:play-solid',  // Icon to display (using Flowbite icons)\n        \n        // Control who can see/use this action\n        allowed: ({ adminUser, standardAllowedActions }) => {\n          return true;  // Allow everyone\n        },\n        \n        // Handler function when action is triggered\n        action: ({ recordId, adminUser }) => {\n          console.log(\"auto submit\", recordId, adminUser);\n          return { \n            ok: true, \n            successMessage: \"Auto submitted\" \n          };\n        },\n\n        // Configure where the action appears\n        showIn: {\n          list: true,              // Show in list view\n          showButton: true,        // Show as a button\n          showThreeDotsMenu: true, // Show in three-dots menu\n        }\n      }\n    ]\n  }\n}\n"})}),"\n",(0,o.jsx)(e.h2,{id:"action-configuration-options",children:"Action Configuration Options"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"name"}),": Display name of the action"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"icon"}),": Icon to show (using Flowbite icon set)"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"allowed"}),": Function to control access to the action"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"action"}),": Handler function that executes when action is triggered"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"showIn"}),": Controls where the action appears","\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"list"}),": Show in list view"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"showButton"}),": Show as a button"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"showThreeDotsMenu"}),": Show in three-dots menu"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(e.h2,{id:"access-control",children:"Access Control"}),"\n",(0,o.jsxs)(e.p,{children:["You can control who can use an action through the ",(0,o.jsx)(e.code,{children:"allowed"})," function. This function receives:"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-ts",metastring:'title="./resources/apartments.ts"',children:"{\n  options: {\n    actions: [\n      {\n        name: 'Auto submit',\n        allowed: ({ adminUser, standardAllowedActions }) => {\n          if (adminUser.dbUser.role !== 'superadmin') {\n            return false;\n          }\n          return true;\n        },\n        // ... other configuration\n      }\n    ]\n  }\n}\n"})}),"\n",(0,o.jsxs)(e.p,{children:["The ",(0,o.jsx)(e.code,{children:"allowed"})," function receives:"]}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"adminUser"}),": The current admin user object"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"standardAllowedActions"}),": Standard permissions for the current user"]}),"\n"]}),"\n",(0,o.jsx)(e.p,{children:"Return:"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"true"})," to allow access"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"false"})," to deny access"]}),"\n",(0,o.jsx)(e.li,{children:"A string with an error message to explain why access was denied"}),"\n"]}),"\n",(0,o.jsxs)(e.p,{children:["Here is how it looks:\n",(0,o.jsx)(e.img,{alt:"alt text",src:t(308).A+"",width:"3700",height:"2044"})]}),"\n",(0,o.jsx)(e.p,{children:"You might want to allow only certain users to perform your custom bulk action."}),"\n",(0,o.jsxs)(e.p,{children:["To implement this limitation use ",(0,o.jsx)(e.code,{children:"allowed"}),":"]}),"\n",(0,o.jsx)(e.p,{children:"If you want to prohibit the use of bulk action for user, you can do it this way:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-ts",metastring:'title="./resources/apartments.ts"',children:"bulkActions: [\n  {\n    label: 'Mark as listed',\n    icon: 'flowbite:eye-solid',\n    state:'active',\n    allowed: async ({ resource, adminUser, selectedIds }) => {\n      if (adminUser.dbUser.role !== 'superadmin') {\n        return false;\n      } \n      return true;\n    },\n    confirm: 'Are you sure you want to mark all selected apartments as listed?',\n    action: function ({selectedIds, adminUser }: {selectedIds: any[], adminUser: AdminUser }, allow) {\n      const stmt = admin.resource('aparts').dataConnector.db.prepare(`UPDATE apartments SET listed = 1 WHERE id IN (${selectedIds.map(() => '?').join(',')}`);\n      stmt.run(...selectedIds);\n      return { ok: true, error: false, successMessage: `Marked ${selectedIds.length} apartments as listed` };\n    },\n  }\n],\n"})}),"\n",(0,o.jsx)(e.h2,{id:"action-url",children:"Action URL"}),"\n",(0,o.jsxs)(e.p,{children:["Instead of defining an ",(0,o.jsx)(e.code,{children:"action"})," handler, you can specify a ",(0,o.jsx)(e.code,{children:"url"})," that the user will be redirected to when clicking the action button:"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-ts",metastring:'title="./resources/apartments.ts"',children:"{\n  name: 'View details',\n  icon: 'flowbite:eye-solid',\n  url: '/resource/aparts',  // URL to redirect to\n  showIn: {\n    list: true,\n    showButton: true,\n    showThreeDotsMenu: true,\n  } \n}\n"})}),"\n",(0,o.jsx)(e.p,{children:"The URL can be:"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"A relative path within your admin panel (starting with '/')"}),"\n",(0,o.jsx)(e.li,{children:"An absolute URL (starting with 'http://' or 'https://')"}),"\n"]}),"\n",(0,o.jsxs)(e.p,{children:["To open the URL in a new tab, add ",(0,o.jsx)(e.code,{children:"?target=_blank"})," to the URL:"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-ts",children:"{\n  name: 'View on Google',\n  icon: 'flowbite:external-link-solid',\n  url: 'https://google.com/search?q=apartment&target=_blank',\n  showIn: {\n    list: true,\n    showButton: true\n  }\n}\n"})}),"\n",(0,o.jsxs)(e.blockquote,{children:["\n",(0,o.jsxs)(e.p,{children:["\u261d\ufe0f Note: You cannot specify both ",(0,o.jsx)(e.code,{children:"action"})," and ",(0,o.jsx)(e.code,{children:"url"})," for the same action - only one should be used."]}),"\n"]})]})}function u(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(d,{...n})}):d(n)}},308:(n,e,t)=>{t.d(e,{A:()=>s});const s=t.p+"assets/images/Custom bulk actions-d43f3c77538ddc5e33c6891692bec9b0.png"},8453:(n,e,t)=>{t.d(e,{R:()=>r,x:()=>a});var s=t(6540);const o={},i=s.createContext(o);function r(n){const e=s.useContext(i);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:r(n.components),s.createElement(i.Provider,{value:e},n.children)}}}]);